<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wine Project</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="wineStyle.css">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
</head>
<body>
<div class="container-fluid" id="header">
    <nav id="navScrollControl" class="navbar fixed-top navbar-light bg-light">
        <a class="navbar-brand" href="#">Wine Project</a>
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a class="nav-link" href="#bg">Background</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#flavor">Flavor Exploration</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#recommend">Recommendation</a>
            </li>
        </ul>
    </nav>
    <div class="card bg-dark text-white" id="splash">
        <img class="card-img" src="./img/splash.jpg">
        <div class="card-img-overlay">
            <div class="card-text">
                <p>We all have this moment. <br><br>
                    Imagine - when you stand in front of the wine aisle of a store, you feel literally overwhelmed.<br>
                    The label on the bottle is very informative, and often too informative to wine novice - cuz nothing really makes sense!</p>
                <p id="key">
                    Should I pick a wine based on its price, brand, variety, rating, region, year, or even more confusingly complex attributes,
                    like acidity, sweetness, bodiness, aromas and colors?
                </p>
                <p>Although a bunch of wine selection guidance is out there, wine preference is so subjective.<br><br>
                    The best way to know whether you like the wine or not is to taste it yourself.
                </p>
            </div>
        </div>
    </div>
</div>
<div data-spy="scroll" data-target="#" data-offset="0" id="main">
    <div class="container-fluid" id="bg">
        <h3>Background</h3>
        <br>
        <div class="row">
            <div class="col-5 offset-1">
                <img src="img/user_viz.png" width="80%">
            </div>
            <div class="col-5">
                <p id="user_content">
                    For people in their 20s, they face a steep learning curve of wines, but they are also most curious to explore and learn.
                    We want to help them navigate the world of wines more easily, based on their preference of flavors to instantly associate.
                    In this process, the 20s can pick a few varieties of wines that are both affordable and high-rated, and when tasting by themselves,
                    they can know about the wines and feel what truly appeals to them.
                    <br>
                </p>
            </div>
        </div>
    </div>

    <br>

    <div class="container-fluid" id="flavor">
        <h3>Flavor Exploration</h3><br>
        <br>
        <div class="row">
            <div class="col-3 offset-1">
                <h5>Choose the preferred wine type: </h5>
            </div>
            <div class="col-2" align="center">
                <img class="wine" id="White" src="img/wine/White.png">
                <br>
                <p>White Wine</p>
            </div>
            <div class="col-2" align="center">
                <img class="wine" id="Red" src="img/wine/Red.png">
                <br>
                <p>Red Wine</p>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-3 offset-1" id="flavor_title"></div>
        </div>
        <br>
        <div class="row" id="flavor_row1"></div>
        <br>
        <div class="row" align="center">
            <div class="col-5 offset-1" id="definition"></div>
            <div class="col-5">
                <div id="flavor_viz"></div>
            </div>
        </div>
    </div>

    <br>

    <div class="container-fluid" id="recommend">
        <div id="recommend_title"></div>
        <br>
        <div class="row">
            <div class="col-8 offset-2" id="details"></div>
        </div>
    </div>
</div>
<br><br>
<!--<footer >-->
    <!--<h5 style="margin:20px;">INFO247 Final Project</h5>-->
<!--</footer>-->
<script>
    //const img_path = "http://localhost/wineproject/img/";
    const img_path = "https://yinan-chen.github.io/wineproject/img/";
    const flavors = {
      "White": ["Citrus Fruit","Stone Fruit","Tropical Fruit","Floral","Herbal"],
      "Red":["Red Fruit","Black Fruit","Floral","Cooking Spice","Leather"]
    };
    var wine = "";
    var flavors_select = {first:"",second:""};
    var flavor_count = 0;

    $(".wine").click(function(e){
        //clean
        $("#definition").html("");
        $("#flavor_viz").html("");

        let curr = e.target;
        if(wine !== "")
            $("#"+wine).attr("src",img_path+"wine/"+wine+".png");
        curr.src = img_path+"wine/"+curr.id+"_select.png";
        wine = curr.id;
        console.log(wine);

        $("#flavor_title").html("<h5>Choose two favorite flavors: </h5>");
        set_flavor_options(curr.id);
    });

    function set_flavor_options(type){
        let options = flavors[type];
        let htmlStr = "<div class='offset-1'></div>";

        options.forEach(function(flavor){
            let id = flavor;
            let name = flavor;
            if(flavor === "Floral"){
                id += type;
            }else if(flavor.includes("Fruit") || flavor.includes("Spice")){
                let subs = flavor.split(" ");
                id = subs[0]+subs[1];
            }
            htmlStr += "<div class='col-2' align='center'>" +
                            "<img class='flavor' id='"+id +"' alt='"+name +"' src='"+img_path+"icon/"+id+".png"+"'>" +
                            "<br>" +
                            "<p>"+name+"</p>" +
                            "</div>";
        });
        $("#flavor_row1").html(htmlStr);
        bindFlavorClickEvent();
    }

    function bindFlavorClickEvent(){
        let definition = $("#definition");
        let viz = $("#flavor_viz");
        $(".flavor").click(function(e){
            let curr = e.target;
            if(curr.src === img_path+"icon/"+curr.id+".png"){
                if(flavor_count < 2){
                    flavor_count === 0? flavors_select.first = curr.id:flavors_select.second = curr.id;
                }else{
                    //clean before
                    definition.html("");
                    viz.html("");
                    flavor_count = 0;
                    let first = $("#"+flavors_select.first);
                    let second = $("#"+flavors_select.second);
                    first.attr('src',img_path+"icon/"+flavors_select.first+".png");
                    second.attr('src',img_path+"icon/"+flavors_select.second+".png");
                    flavors_select.first = curr.id;
                }
                curr.src = img_path+"icon/"+curr.id+"_select.png";
                flavor_count++;
                let strHtml = definition.html();
                strHtml += "<img src='img/scale/explain"+flavor_count+".png' width='75%' style='padding-top: 5em;'>";
                definition.html(strHtml);
            }else {
                curr.src = img_path+"icon/"+curr.id+".png";
                flavor_count--;
                viz.html("");
                if(flavor_count === 0){
                    definition.html("");
                }else {
                    definition.html("<img src='img/scale/explain1.png' width='75%' style='padding-top: 5em;'>");
                }
            }
            console.log(flavors_select);
            console.log(flavor_count);

            //call to generate flavor viz
            if(flavor_count === 2){
                viz.html("");
                getFlavorViz(wine,$("#"+flavors_select.first).attr("alt"),$("#"+flavors_select.second).attr("alt"));
            }

        });
    }
</script>
<script src="wineViz.js"></script>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>